
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Welcome to ElasticPyProxy’s documentation! &#8212; ElasticPyProxy 1.0 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="welcome-to-elasticpyproxy-s-documentation">
<h1>Welcome to ElasticPyProxy’s documentation!<a class="headerlink" href="#welcome-to-elasticpyproxy-s-documentation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="elasticpyproxy-code-documentation">
<h2>ElasticPyProxy Code Documentation<a class="headerlink" href="#elasticpyproxy-code-documentation" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
</div>
</div>
<div class="section" id="module-src.driver.driver">
<span id="driver-main-entry-point-for-elasticpyproxy"></span><h2>driver (Main entry point for ElasticPyProxy)<a class="headerlink" href="#module-src.driver.driver" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-driver"></span><dl class="function">
<dt id="src.driver.driver.drive">
<code class="sig-prename descclassname">src.driver.driver.</code><code class="sig-name descname">drive</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/driver/driver.html#drive"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.driver.driver.drive" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>Method for starting ep2</strong></p>
<p>This is the entry method which starts ep2 controller. It calls bootstrap module
for bootstrapping ep2, reads ep2 config, initialises haproxy and starts the
<strong>poll-update-repeat loop</strong></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Returns nothing</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-src.driver.drivercache">
<span id="drivercache-cache-layer-for-ep2"></span><h2>drivercache : Cache layer for EP2<a class="headerlink" href="#module-src.driver.drivercache" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-drivercache"></span><dl class="class">
<dt id="src.driver.drivercache.DriverCache">
<em class="property">class </em><code class="sig-prename descclassname">src.driver.drivercache.</code><code class="sig-name descname">DriverCache</code><span class="sig-paren">(</span><em class="sig-param">node_ips</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/driver/drivercache.html#DriverCache"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.driver.drivercache.DriverCache" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to provide caching for ep2</p>
<p>The backends fetched in a given run is stored in memory.
The backends fetched in next run witll be compared to the ones already
held by this class (node_ips). If there is a mismatch, only then update
will be done</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>node_ips</strong> (<em>list</em>) – list of backend IPs</p>
</dd>
</dl>
<dl class="method">
<dt id="src.driver.drivercache.DriverCache.need_to_update">
<code class="sig-name descname">need_to_update</code><span class="sig-paren">(</span><em class="sig-param">node_ips</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/driver/drivercache.html#DriverCache.need_to_update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.driver.drivercache.DriverCache.need_to_update" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to check if haproxy needs to be updated</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>node_ips</strong> (<em>list</em>) – list of backend IPs</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Whether to update haproxy or not</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-src.driver.bootstrap">
<span id="bootstrap-bootstrapper-for-ep2"></span><h2>bootstrap : Bootstrapper for ep2<a class="headerlink" href="#module-src.driver.bootstrap" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-bootstrap"></span><dl class="function">
<dt id="src.driver.bootstrap.bootstrap">
<code class="sig-prename descclassname">src.driver.bootstrap.</code><code class="sig-name descname">bootstrap</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/driver/bootstrap.html#bootstrap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.driver.bootstrap.bootstrap" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to bootstrap EP2 controller</p>
<p>This method bootstraps EP2 to creates the neccessary objects and returns it
to the driver.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>**kwargs</strong> (<em>object</em>) – kwargs must contains config dictionary, logger object.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Whether bootstrap updater was successfull or not
src.core.haproxyupdater.haproxyupdate.HaproxyUPdate: Object for updating haproxy config
src.core.nodefetchers.basefetcher: Object for fetching backends</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-src.core.haproxyupdater.haproxyupdate">
<span id="haproxyupdate-module-for-updating-haproxy"></span><h2>haproxyupdate : Module for updating haproxy<a class="headerlink" href="#module-src.core.haproxyupdater.haproxyupdate" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-haproxyupdate"></span><dl class="class">
<dt id="src.core.haproxyupdater.haproxyupdate.HaproxyUpdate">
<em class="property">class </em><code class="sig-prename descclassname">src.core.haproxyupdater.haproxyupdate.</code><code class="sig-name descname">HaproxyUpdate</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/core/haproxyupdater/haproxyupdate.html#HaproxyUpdate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.core.haproxyupdater.haproxyupdate.HaproxyUpdate" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for handling haproxy update and reload</p>
<p>This class contains handlers which controls haproxy uptation and reload.
Haproxy can be updated wither by updating its config file followed by
a reload via systemd or via binary. The other way to reload haproxy is
via the exposed socket. This type of update does not require any reload</p>
<p>For updating via runtime haproxy needs to maintain a pool if inactive
backends. When a new live backend comes, we can pull an inactive live backend
and make it live changing its ip to that of the live backend</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>**kwargs</strong> (<em>dictionary</em>) – params in key/value dict format</p>
</dd>
</dl>
<dl class="attribute">
<dt id="src.core.haproxyupdater.haproxyupdate.HaproxyUpdate.logger">
<code class="sig-name descname">logger</code><em class="property"> = None</em><a class="headerlink" href="#src.core.haproxyupdater.haproxyupdate.HaproxyUpdate.logger" title="Permalink to this definition">¶</a></dt>
<dd><p>Valid methods to start haproxy.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>init methods is not supported yet.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="src.core.haproxyupdater.haproxyupdate.HaproxyUpdate.update_haproxy">
<code class="sig-name descname">update_haproxy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/core/haproxyupdater/haproxyupdate.html#HaproxyUpdate.update_haproxy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.core.haproxyupdater.haproxyupdate.HaproxyUpdate.update_haproxy" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates haproxy config</p>
<p>This method updates haproxy config with the help of the util methods.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Wether haproxy was updated successfully or not.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="src.core.haproxyupdater.haproxyupdate.HaproxyUpdate.update_haproxy_by_config_reload">
<code class="sig-name descname">update_haproxy_by_config_reload</code><span class="sig-paren">(</span><em class="sig-param">update_only=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/core/haproxyupdater/haproxyupdate.html#HaproxyUpdate.update_haproxy_by_config_reload"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.core.haproxyupdater.haproxyupdate.HaproxyUpdate.update_haproxy_by_config_reload" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to update haproxy via config reload</p>
<p>This method will update haproxy via updating its config and subsequently reloading it.
The actual update will be done by the confighandler module and reload will be
done by haproxyreloader. Optinaly is <strong>upate_only</strong> is set to True then only config
will be updated and reload will not be done.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>update_only</strong> (<em>bool</em>) – Whether only update is required or both update and reload is required.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Whether successfully updated/reloaded as the case may be</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="src.core.haproxyupdater.haproxyupdate.HaproxyUpdate.update_node_list">
<code class="sig-name descname">update_node_list</code><span class="sig-paren">(</span><em class="sig-param">node_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/core/haproxyupdater/haproxyupdate.html#HaproxyUpdate.update_node_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.core.haproxyupdater.haproxyupdate.HaproxyUpdate.update_node_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to update active node list</p>
<p>This method will e called to update the list of active backends.
Haproxy needs to be updated and optionally reloaded if this list changes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>node_list</strong> (<em>list</em>) – List containing IPs/Hostnames of active backends</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="src.core.haproxyupdater.haproxyupdate.HaproxyUpdate.valid_start_by">
<code class="sig-name descname">valid_start_by</code><em class="property"> = None</em><a class="headerlink" href="#src.core.haproxyupdater.haproxyupdate.HaproxyUpdate.valid_start_by" title="Permalink to this definition">¶</a></dt>
<dd><p>Valid methods to update haproxy</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-src.core.haproxyupdater.confighandler">
<span id="confighandler-module-for-updating-haproxy"></span><h2>confighandler : Module for updating haproxy<a class="headerlink" href="#module-src.core.haproxyupdater.confighandler" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-confighandler"></span><dl class="class">
<dt id="src.core.haproxyupdater.confighandler.ConfigHandler">
<em class="property">class </em><code class="sig-prename descclassname">src.core.haproxyupdater.confighandler.</code><code class="sig-name descname">ConfigHandler</code><a class="reference internal" href="_modules/src/core/haproxyupdater/confighandler.html#ConfigHandler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.core.haproxyupdater.confighandler.ConfigHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to handler haproxy config file updation</p>
<p>This class contains method for updating the haproxy config file
with the provided formatted haproxy config template.</p>
<p>The template is first populated with the fetched backends using jinja templating
engine and then the haproxy config file is updated with this formatted template.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>**kwargs</strong> (<em>dictionary</em>) – Dictionary containing params</p>
</dd>
</dl>
<dl class="method">
<dt id="src.core.haproxyupdater.confighandler.ConfigHandler.read_write_file">
<em class="property">static </em><code class="sig-name descname">read_write_file</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/core/haproxyupdater/confighandler.html#ConfigHandler.read_write_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.core.haproxyupdater.confighandler.ConfigHandler.read_write_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to read and write haproxy config file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>**kwargs</strong> (<em>dictionary</em>) – Dictionary containing params</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>successfully updated or not
str : error string if any</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="src.core.haproxyupdater.confighandler.ConfigHandler.update_config">
<em class="property">static </em><code class="sig-name descname">update_config</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/core/haproxyupdater/confighandler.html#ConfigHandler.update_config"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.core.haproxyupdater.confighandler.ConfigHandler.update_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Method for updating haproxy config</p>
<p>This is the method which actually updates the haproxy config file
using the provided template file after properly formatting it</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>**kwargs</strong> (<em>dictionary</em>) – Dictionary containing params</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Successfully updated or not</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-src.core.haproxyupdater.haproxyreloader">
<span id="haproxyreloader-module-for-reloading-haproxy"></span><h2>haproxyreloader : Module for reloading haproxy<a class="headerlink" href="#module-src.core.haproxyupdater.haproxyreloader" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-haproxyreloader"></span><dl class="class">
<dt id="src.core.haproxyupdater.haproxyreloader.HaproxyReloader">
<em class="property">class </em><code class="sig-prename descclassname">src.core.haproxyupdater.haproxyreloader.</code><code class="sig-name descname">HaproxyReloader</code><a class="reference internal" href="_modules/src/core/haproxyupdater/haproxyreloader.html#HaproxyReloader"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.core.haproxyupdater.haproxyreloader.HaproxyReloader" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for handling haproxy reload</p>
<p>This class provides methods to reload haproxy, either
via systemd or via the binary.</p>
<p>In order to reload via bianry, the socket file and the PID file
should be present as params along with the binary location.</p>
<p>For systemd, the systemd service name should be provided
as param.</p>
<p>Both reload via systemd and reload via binary are done by execting shell
commands via subprocess library</p>
<dl class="method">
<dt id="src.core.haproxyupdater.haproxyreloader.HaproxyReloader.reload_haproxy">
<em class="property">static </em><code class="sig-name descname">reload_haproxy</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/core/haproxyupdater/haproxyreloader.html#HaproxyReloader.reload_haproxy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.core.haproxyupdater.haproxyreloader.HaproxyReloader.reload_haproxy" title="Permalink to this definition">¶</a></dt>
<dd><p>Method for reloading haproxy</p>
<p>Method for reloading haproxy. This takes the help of util method to reload
haproxy either via systemd or binary.</p>
<p>Other classes and methods will call this method for updating haporoxy
with the required param.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>**kwargs</strong> (<em>dictionary</em>) – Dictionary conatining params</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Successfully reloaded or not</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="src.core.haproxyupdater.haproxyreloader.HaproxyReloader.start_by_systemd">
<em class="property">static </em><code class="sig-name descname">start_by_systemd</code><span class="sig-paren">(</span><em class="sig-param">service_name</em>, <em class="sig-param">logger=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/core/haproxyupdater/haproxyreloader.html#HaproxyReloader.start_by_systemd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.core.haproxyupdater.haproxyreloader.HaproxyReloader.start_by_systemd" title="Permalink to this definition">¶</a></dt>
<dd><p>Method for starting haproxy via systemd</p>
<p>Starts haproxy via systemd. Executes systemd start as a shell command.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>logger</strong> (<em>object</em>) – logger object for logging</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Successfully started or not</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-src.core.haproxyupdater.runtimeupdater">
<span id="runtimeupdater-module-for-updating-haproxy-at-runtime"></span><h2>runtimeupdater : Module for updating haproxy at runtime<a class="headerlink" href="#module-src.core.haproxyupdater.runtimeupdater" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-runtimeupdater"></span><dl class="class">
<dt id="src.core.haproxyupdater.runtimeupdater.RuntimeUpdater">
<em class="property">class </em><code class="sig-prename descclassname">src.core.haproxyupdater.runtimeupdater.</code><code class="sig-name descname">RuntimeUpdater</code><a class="reference internal" href="_modules/src/core/haproxyupdater/runtimeupdater.html#RuntimeUpdater"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.core.haproxyupdater.runtimeupdater.RuntimeUpdater" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for updating haproxy at runtime</p>
<p>This class conatins methods for updating haproxy backends at
runtime without reloading it.</p>
<p>This is done by communicating with haproxy over the unix
socket file expsed by it.</p>
<p>Once ep2 gets the ips/hostnames of the live backends, it
communicates with haproxy over socket, extracts servers
from inactive pool and updating their address with that of
the live ones.</p>
<dl class="method">
<dt id="src.core.haproxyupdater.runtimeupdater.RuntimeUpdater.update_haproxy_runtime">
<em class="property">static </em><code class="sig-name descname">update_haproxy_runtime</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/core/haproxyupdater/runtimeupdater.html#RuntimeUpdater.update_haproxy_runtime"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.core.haproxyupdater.runtimeupdater.RuntimeUpdater.update_haproxy_runtime" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to update haproxy at runtime using the util method present above</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>**kwargs</strong> (<em>dictionary</em>) – Dictionary containing params</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Successfully updated haproxy or not
stats : dictionary containing active nodes and inactive node count</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="src.core.haproxyupdater.runtimeupdater.RuntimeUpdater.update_runtime_util">
<em class="property">static </em><code class="sig-name descname">update_runtime_util</code><span class="sig-paren">(</span><em class="sig-param">haproxy_sock</em>, <em class="sig-param">node_ips</em>, <em class="sig-param">nodes</em>, <em class="sig-param">backend_name</em>, <em class="sig-param">port</em>, <em class="sig-param">logger=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/core/haproxyupdater/runtimeupdater.html#RuntimeUpdater.update_runtime_util"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.core.haproxyupdater.runtimeupdater.RuntimeUpdater.update_runtime_util" title="Permalink to this definition">¶</a></dt>
<dd><p>Method for updating haproxy backends using unix socket</p>
<p>This method updates the haproxy backends by sending commands over the
exposed unix socket.</p>
<p><strong>Working</strong></p>
<ul class="simple">
<li><p>First it iterates over the active backends currently present in haproxy.</p></li>
<li><p>If they are not present in the current fetched list of backends, then we
disable those backends and add them to the inactive pool.</p></li>
<li><p>Next we iterate over the list of current live nodes fetched from orchestrator</p></li>
<li><p>if they are already present as live backends in haproxy <strong>even after the above
elimination</strong> then we skip.</p></li>
<li><p>If they are not present then we fetch a inactive node from the inactive pool,
change its address to that of the live node and enable back that node.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>haproxy_sock</strong> (<em>str</em>) – Location of the haproxy unix socket file</p></li>
<li><p><strong>node_ips</strong> (<em>list</em>) – List of current live nodes fetched from orchestrator. (IP or hostname)</p></li>
<li><p><strong>nodes</strong> (<em>dictionary</em>) – Dictionary conatining haproxy active and inactive backends</p></li>
<li><p><strong>backend_name</strong> (<em>str</em>) – Name of the haproxy backend that needs to be updated.</p></li>
<li><p><strong>port</strong> (<em>int</em>) – port for the backend nodes</p></li>
<li><p><strong>logger</strong> (<em>object</em>) – Logger object</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Retuns:</dt><dd><p>dict : Dictionary conatining active node_ips and inactive nodes count</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-src.core.haproxyupdater.sockethandler">
<span id="sockethandler-module-for-handling-socket-operations"></span><h2>sockethandler : Module for handling socket operations<a class="headerlink" href="#module-src.core.haproxyupdater.sockethandler" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-sockethandler"></span><dl class="class">
<dt id="src.core.haproxyupdater.sockethandler.SocketHandler">
<em class="property">class </em><code class="sig-prename descclassname">src.core.haproxyupdater.sockethandler.</code><code class="sig-name descname">SocketHandler</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/core/haproxyupdater/sockethandler.html#SocketHandler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.core.haproxyupdater.sockethandler.SocketHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>Class containing methods for handling socket operation</p>
<p>This is a generic class for handling all socket operation.
All the commands which are to be sent to haproxy and done via methods in
this class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>**kwargs</strong> (<em>dictionary</em>) – Dictionary containing params</p>
</dd>
</dl>
<dl class="method">
<dt id="src.core.haproxyupdater.sockethandler.SocketHandler.connect_socket">
<code class="sig-name descname">connect_socket</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/core/haproxyupdater/sockethandler.html#SocketHandler.connect_socket"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.core.haproxyupdater.sockethandler.SocketHandler.connect_socket" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to connect to haproxy unix socket</p>
<p>This method creates a socket connection to the given haproxy unix socket</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Successfully created socket connection or not</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="src.core.haproxyupdater.sockethandler.SocketHandler.send_command">
<code class="sig-name descname">send_command</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/core/haproxyupdater/sockethandler.html#SocketHandler.send_command"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.core.haproxyupdater.sockethandler.SocketHandler.send_command" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to send command to haproxy unix socket and get response</p>
<p>It will first create a socket connection to the haproxy socket
and then send the given command and get response.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>**kwargs</strong> (<em>dictionary</em>) – Dictionary containing params</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Successfully sent command or not
str : response sent by the haproxy unix socket</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-src.core.nodefetchers.basefetcher">
<span id="basefetcher-provides-base-class-for-backend-fetchers"></span><h2>basefetcher : Provides base class for backend fetchers<a class="headerlink" href="#module-src.core.nodefetchers.basefetcher" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-basefectcher"></span><dl class="class">
<dt id="src.core.nodefetchers.basefetcher.BaseFetcher">
<em class="property">class </em><code class="sig-prename descclassname">src.core.nodefetchers.basefetcher.</code><code class="sig-name descname">BaseFetcher</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/core/nodefetchers/basefetcher.html#BaseFetcher"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.core.nodefetchers.basefetcher.BaseFetcher" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for all kinds of backend fetchers</p>
<p>This class is the base/super class for all backend fetchers.
Individual backend fetchers have to inherit this class and
an optionally override the methods present in this class</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>**kwargs</strong> (<em>dictionary</em>) – Dictionary containing params</p>
</dd>
</dl>
<dl class="method">
<dt id="src.core.nodefetchers.basefetcher.BaseFetcher.fetch">
<code class="sig-name descname">fetch</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/core/nodefetchers/basefetcher.html#BaseFetcher.fetch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.core.nodefetchers.basefetcher.BaseFetcher.fetch" title="Permalink to this definition">¶</a></dt>
<dd><p>Method for fecthing backend nodes from orchestrator</p>
<p>Make request for nodes. Should be overridden by individual fetchers</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-src.core.nodefetchers.orchestrator">
<span id="orchestrator-module-for-providing-appropriate-backend-fetcher"></span><h2>orchestrator : Module for providing appropriate backend fetcher<a class="headerlink" href="#module-src.core.nodefetchers.orchestrator" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-orchestrator"></span><dl class="function">
<dt id="src.core.nodefetchers.orchestrator.get_orchestrator_handler">
<code class="sig-prename descclassname">src.core.nodefetchers.orchestrator.</code><code class="sig-name descname">get_orchestrator_handler</code><span class="sig-paren">(</span><em class="sig-param">config</em>, <em class="sig-param">logger=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/core/nodefetchers/orchestrator.html#get_orchestrator_handler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.core.nodefetchers.orchestrator.get_orchestrator_handler" title="Permalink to this definition">¶</a></dt>
<dd><p>Method for deciding which fetcher to use</p>
<p>Decide which fetcher to use depending on the orchestrator mentioned
in the config.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<em>dictionary</em>) – dictionary holding ep2 config</p></li>
<li><p><strong>logger</strong> (<em>object</em>) – logger object</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Backend fetcher</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="src.core.nodefetchers.orchestrator.prepare_aws_handler">
<code class="sig-prename descclassname">src.core.nodefetchers.orchestrator.</code><code class="sig-name descname">prepare_aws_handler</code><span class="sig-paren">(</span><em class="sig-param">config</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/core/nodefetchers/orchestrator.html#prepare_aws_handler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.core.nodefetchers.orchestrator.prepare_aws_handler" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepares the AWS fetcher</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>config</strong> (<em>dictionary</em>) – dictionary containing ep2 config</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Aws backend fetecher</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>srv.nodefetchers.awsfetcher.awsfetcher</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-src.core.nodefetchers.awsfetcher.awsfetcher">
<span id="awsfetcher-module-for-fecthing-live-backends-from-aws"></span><h2>awsfetcher : Module for fecthing live backends from AWS<a class="headerlink" href="#module-src.core.nodefetchers.awsfetcher.awsfetcher" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-awsfetcher"></span><dl class="class">
<dt id="src.core.nodefetchers.awsfetcher.awsfetcher.AwsFetcher">
<em class="property">class </em><code class="sig-prename descclassname">src.core.nodefetchers.awsfetcher.awsfetcher.</code><code class="sig-name descname">AwsFetcher</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/core/nodefetchers/awsfetcher/awsfetcher.html#AwsFetcher"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.core.nodefetchers.awsfetcher.awsfetcher.AwsFetcher" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for fetching libe backends from AWS</p>
<p>Contains methods to fetch live backends from AWS using the boto3 library
To make this class work properly, ep2 config must have aws section with
access_key_id and secret_access_token specified along with aws region
and ip_type which is required (public or private)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>**kwargs</strong> (<em>dictionary</em>) – Dictionary containing params</p>
</dd>
</dl>
<dl class="method">
<dt id="src.core.nodefetchers.awsfetcher.awsfetcher.AwsFetcher.fetch">
<code class="sig-name descname">fetch</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/core/nodefetchers/awsfetcher/awsfetcher.html#AwsFetcher.fetch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.core.nodefetchers.awsfetcher.awsfetcher.AwsFetcher.fetch" title="Permalink to this definition">¶</a></dt>
<dd><p>Method for fetching backends</p>
<p>This method takes help of BotoHandler for fetching backends from AWS
and return them to the caller</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>List of backends</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-src.core.nodefetchers.awsfetcher.botohandler">
<span id="botohandler-module-for-handling-aws-operations"></span><h2>botohandler : Module for handling AWS operations<a class="headerlink" href="#module-src.core.nodefetchers.awsfetcher.botohandler" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-botohandler"></span><dl class="class">
<dt id="src.core.nodefetchers.awsfetcher.botohandler.BotoHandler">
<em class="property">class </em><code class="sig-prename descclassname">src.core.nodefetchers.awsfetcher.botohandler.</code><code class="sig-name descname">BotoHandler</code><a class="reference internal" href="_modules/src/core/nodefetchers/awsfetcher/botohandler.html#BotoHandler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.core.nodefetchers.awsfetcher.botohandler.BotoHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for handling aws node fetching operations</p>
<p>Methods in this class handle aws operations for retreiving the
list of active backends. It first uses boto3 asg client for
describing the asg of interest. Once we have the instance ids
in that asg, we use ec2 client for describing those instances
for getting their public/private ips</p>
<dl class="method">
<dt id="src.core.nodefetchers.awsfetcher.botohandler.BotoHandler.get_auto_scaling_client">
<em class="property">static </em><code class="sig-name descname">get_auto_scaling_client</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/core/nodefetchers/awsfetcher/botohandler.html#BotoHandler.get_auto_scaling_client"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.core.nodefetchers.awsfetcher.botohandler.BotoHandler.get_auto_scaling_client" title="Permalink to this definition">¶</a></dt>
<dd><p>Method for initialising asg boto client</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>**kwargs</strong> (<em>object</em>) – kwargs must contains config dictionary, logger object.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>boto3 asg client</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>boto3.client</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="src.core.nodefetchers.awsfetcher.botohandler.BotoHandler.get_ec2_client">
<em class="property">static </em><code class="sig-name descname">get_ec2_client</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/core/nodefetchers/awsfetcher/botohandler.html#BotoHandler.get_ec2_client"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.core.nodefetchers.awsfetcher.botohandler.BotoHandler.get_ec2_client" title="Permalink to this definition">¶</a></dt>
<dd><p>Method for initialising ec2 boto client</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>**kwargs</strong> (<em>object</em>) – kwargs must contains config dictionary, logger object.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>boto3 ec2 client</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>boto3.client</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="src.core.nodefetchers.awsfetcher.botohandler.BotoHandler.get_instance_ips_for_asg">
<em class="property">static </em><code class="sig-name descname">get_instance_ips_for_asg</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/core/nodefetchers/awsfetcher/botohandler.html#BotoHandler.get_instance_ips_for_asg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.core.nodefetchers.awsfetcher.botohandler.BotoHandler.get_instance_ips_for_asg" title="Permalink to this definition">¶</a></dt>
<dd><p>Method for getting aws live instance IPs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>**kwargs</strong> (<em>object</em>) – kwargs must contains config dictionary, logger object.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of live backend IPs</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="#">ElasticPyProxy</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="#">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, Deepjyoti Mondal.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.2.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>